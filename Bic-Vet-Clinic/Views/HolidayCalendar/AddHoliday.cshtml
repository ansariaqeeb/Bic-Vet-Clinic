
@model DataModel.Master.holidayCalendar
@{
    Layout = null;
}

<div class="row">
    @using (Ajax.BeginForm("AddHoliday", "HolidayCalendar", null, new AjaxOptions { OnBegin = "", OnComplete = "", OnSuccess = "OnSuccess", OnFailure = "" }, new { @id = "frmAddState" }))
    {
        <div class="col-sm-12 col-xs-12">
            <div class="form-group col-sm-6 col-xs-12">
                <div class="form-group col-sm-12 col-xs-12">
                    <label class="col-sm-4 col-xs-12 control-label no-padding-right align-left">Year <span class="red clsStar"><sub>*</sub></span></label>
                    <div class="col-sm-8 col-xs-12">
                       
                        <input type="text" name="Year" class="col-sm-12 col-xs-12 no-padding clsreq" value="0" id="Year">
                    </div>
                </div>
                <div class="form-group col-sm-12 col-xs-12">
                    <label class="col-sm-4 col-xs-12 control-label no-padding-right align-left">Holiday Date <span class="red clsStar"><sub>*</sub></span></label>
                    
                    <div class="col-sm-8">
                        <div class="col-sm-12 col-xs-12 input-group input-group-sm no-padding"> 
                            <input autocomplete="off" type="text" data-date-format="dd-M-yyyy" value="" class="form-control date-picker col-xs-5 col-sm-5 clsreq" placeholder="Select Holiday Date" name="HolidayDate" id="HolidayDate">
                             
                            <span class="input-group-addon" style="padding-top:4px; padding-bottom:2px;">
                                <i class="fa fa-calendar bigger-110 blue"></i>
                            </span>
                        </div>
                    </div>

                </div>
            </div>

            <div class="form-group col-sm-6 col-xs-12">
                <div class="form-group col-sm-12 col-xs-12">
                    <label class="col-sm-4 col-xs-12 control-label no-padding-right align-left">Holiday Description <span class="red clsStar"><sub>*</sub></span></label>
                    <div class="col-sm-8 col-xs-12">
                        @Html.TextAreaFor(a => a.Description, new { @class = "col-xs-12 col-sm-12 clsreq", @autocomplete = "off", placeholder = "Enter Holiday Description", maxlength = 150 })
                    </div>
                </div>
            </div>
        </div>

        <div class="form-group">
            <div class="col-sm-12 col-xs-12 modal-footer" style="text-align:right">
                <button id="btnSubmit" type="submit" class="btn btn-xs btn-info" onclick="return Validater();">
                    <i title="Save" style="cursor: pointer; font-style: normal;" class="fa fa-check"></i> Save
                </button>
                <button id="btnCancel" data-dismiss="modal" type="button" class="btn btn-danger btn-xs">
                    <i title="Cancel" class="ace-icon fa fa-times"></i> Cancel
                </button>
            </div>
        </div>
                                }
</div>
<script src="~/Scripts/jquery.unobtrusive-ajax.js"></script>
<script type="text/javascript">
    //Script for showing success or error message on page
    function OnSuccess(res) {
       
        var errid = res.ResultId;
        var errmsg = res.Message;
        var TITLE = res.Title;
        var TYPE = res.Type; 
        if (parseInt(errid) < 0) {
            $.c9Message(errmsg, TITLE, TYPE);
        }
        else {
            $('#Addpopup_box').modal('hide');
            $.c9Message(errmsg, TITLE, TYPE);
        }
    }

    $(document).ready(function () {
        setTimeout(function () { $("#Year").select2("focus", "val"); }, 500);


        $('.date-picker').datepicker({ autoclose: true, orientation: 'top auto' }).next().on(ace.click_event, function () {
            $(this).prev().focus();
        });


        //Year select2
        $("#Year").select2({
            placeholder: "Select Year",
            allowClear: true,
            multiple: false,
            ajax: {
                url: "/CommonLibrary/_FillControlNo",
                data: function (term, page) {
                    return {
                        CONTROLENO: 0,
                        DESCRIPTION: term
                    };
                },
                results: function (data) {
                    return { results: data };
                }
            },
            initSelection: function (element, callback) {
                $.ajax({
                    dataType: "json",
                    url: "/CommonLibrary/_FillControlNo/",
                    data: { CONTROLENO: 0, DESCRIPTION: @DateTime.Now.Year.ToString() }
                }).done(function (data) {
                     
                    

                    $("#Year").select2('data',{id:data[0].id,text:data[0].text});
                    var yearData = $("#Year").select2('data');
                    $('#HolidayDate').val('');
                    $('#HolidayDate').datepicker('setStartDate', '1/1/' + yearData.text);
                    $('#HolidayDate').datepicker('setEndDate', '31/12/' + yearData.text);
                });
            }
        }).on('change', function () {
            var yearData = $("#Year").select2('data'); 
            $('#HolidayDate').val('');
            $('#HolidayDate').datepicker('setStartDate', '1/1/' + yearData.text);
            $('#HolidayDate').datepicker('setEndDate', '31/12/' + yearData.text);
        });
    });

    //Validation For State Field
    function Validater() {
        if ($("#Year").val() == 0 || $("#Year").val() == "") {
            $.c9Message('Please Select Year', 'Warning', 'W');
            $("#Year").select2('focus');
            return false;
        }
        else if ($("#HolidayDate").val() == 0 || $("#HolidayDate").val() == "") {
            $.c9Message('Please Select Holiday Date', 'Warning', 'W');
            $("#HolidayDate").focus();
            return false;
        } 
        else if ($("#Description").val().trim() == 0 || $("#Description").val().trim() == "") {
            $.c9Message('Please Enter Holiday Description', 'Warning', 'W');
            $("#Description").focus();
            $("#Description").val("");
            return false;
        }

    }
</script>




