(function(n){function i(i,r){var o=r.data,u={},s=[],f,h,e;this.opts=r;this.$container=i;f=this;this.draw=function(){i.empty().append(s[0].render(r));i.find(".node").click(function(){if(f.opts.onClickNode!==null)f.opts.onClickNode(u[n(this).attr("node-id")])});r.allowEdit&&i.find(".node h2").click(function(t){var i=n(this).parent().attr("node-id");f.startEdit(i);t.stopPropagation()});i.find(".org-button").click(function(t){var i=n(this).parent().attr("node-id");if(f.opts.onAddNode!==null)f.opts.onAddNode(u[i]);else f.newNode(i);t.stopPropagation()});i.find(".org-del-button").click(function(t){var i=n(this).parent().attr("node-id");if(f.opts.onDeleteNode!==null)f.opts.onDeleteNode(u[i]);else f.deleteNode(i);t.stopPropagation()})};this.startEdit=function(t){var e=n('<input class="org-input" type="text" readonly="readonly" value="'+u[t].data.name+'"/>'),o;i.find("div[node-id="+t+"] h2").replaceWith(u[t].data.name);o=function(){var i=n("<div>"+u[t].data.name+"<\/div>");r.allowEdit&&i.click(function(){f.startEdit(t)});e.replaceWith(i)};e.focus();e.keyup(function(n){n.which==13?o():u[t].data.name=e.val()});e.blur(function(){o()})};this.newNode=function(t,i,r,e,o,s,h,c,l){var v=[],a;if(typeof u[i]!="undefined"){if(u[i].children.length>0)for(a=0;a<u[i].children.length;a++)v.push(u[i].children[a].data.id);v.indexOf(t)==-1?f.addNode({id:t,name:r,parent:i,level:e,nextlvl:o,customer:s,levelDesc:h,nxtLvlDesc:c,Image:l}):(f.deleteNode(t),f.addNode({id:t,name:r,parent:i,level:e,nextlvl:o,customer:s,levelDesc:h,nxtLvlDesc:c,Image:l}));n(".divtooltip").tooltip()}};this.addNode=function(n){var i=new t(n);u[n.id]=i;u[n.parent].addChild(i);f.draw();f.startEdit(n.id)};this.deleteNode=function(n){for(var t=0;t<u[n].children.length;t++)f.deleteNode(u[n].children[t].data.id);u[u[n].data.parent].removeChild(n);delete u[n];f.draw()};this.getData=function(){var n=[];for(var t in u)n.push(u[t].data);return n};for(e in o)h=new t(o[e]),u[o[e].id]=h;for(e in u)u[e].data.parent==0?s.push(u[e]):u[u[e].data.parent].addChild(u[e]);i.addClass("orgChart");f.draw()}function t(t){this.data=t;this.children=[];var i=this;this.addChild=function(n){this.children.push(n)};this.removeChild=function(n){for(var t=0;t<i.children.length;t++)if(i.children[t].data.id==n){i.children.splice(t,1);return}};this.render=function(n){var t=i.children.length,r,e,o,f,u;if(r="<table id='charttable' cellpadding='0' cellspacing='0' border='0'>",e=t>0?2*t:2,r+="<tr class='chartnodes'><td colspan='"+e+"'>"+i.formatNode(n)+"<\/td><\/tr>",t>0){for(o="<table cellpadding='0' cellspacing='0' border='0'><tr class='lines x'><td class='line left half'><\/td><td class='line right half'><\/td><\/table>",r+="<tr  class='lines'><td colspan='"+t*2+"'>"+o+"<\/td><\/tr>",f="",u=0;u<t;u++)f+=t==1?"<td class='line left half'><\/td>":u==0?"<td class='line left'><\/td>":"<td class='line left top'><\/td>",f+=t==1?"<td class='line right half'><\/td>":u==t-1?"<td class='line right'><\/td>":"<td class='line right top'><\/td>";r+="<tr class='lines v'>"+f+"<\/tr>";r+="<tr>";for(u in i.children)r+="<td colspan='2' class='ClsLast'>"+i.children[u].render(n)+"<\/td>";r+="<\/tr>"}return r+"<\/table>"};this.formatNode=function(r){var f="",e="",o,u;return strempinfo="",typeof t.name!="undefined"&&(f="<div id="+this.data.id+' class="divtooltip" data-toggle="tooltip" data-placement="top" style=height:55px;  title="'+this.data.customer+'">'+i.data.name+" ("+i.data.levelDesc+")<\/div>"),typeof t.description!="undefined"&&(e="<p>"+i.data.description+"<\/p>"),o=this.data.id,n.ajax({url:"/UserControl/EmployeeInfo",data:{CtrlID:"emp_"+this.data.id},async:!1,success:function(n){strempinfo="<div id='LoadEmp_"+o+"'>"+n+"<\/div>"}}),r.showControls?(u="",this.data.nextlvl>0,u="<div class='org-button divtooltip'>"+strempinfo+"<\/div>"):u="<div class='org-button divtooltip'>"+strempinfo+"<\/div>","<div class='node' node-lvlid='"+this.data.level+"' node-pid='"+this.data.parent+"' node-id='"+this.data.id+"'>"+f+e+u+"<img  id='image' style='width: 30px; height: 30px;float:right;'src='"+i.data.Image+"'><div><input type='hidden' id='emp_"+this.data.id+"' value='"+this.data.id+"' /><\/div><\/div>"}}n.fn.orgChart=function(t){var r=n.extend({},n.fn.orgChart.defaults,t);return new i(n(this),r)};n.fn.orgChart.defaults={data:[{id:1,name:"Root",parent:0,level:0}],showControls:!1,allowEdit:!1,onAddNode:null,onDeleteNode:null,onClickNode:null,newNodeText:"Add Child"}})(jQuery);
//# sourceMappingURL=jquery.orgchart.min.js.map
